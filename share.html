<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PinoyTechFeed Â· Share Dashboard</title>
<meta name="robots" content="noindex,nofollow" />
<style>
  :root { --bg:#0b1220; --fg:#e2e8f0; --muted:#94a3b8; --card:#0f172a; --brd:#213048; --accent:#22c55e;}
  body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue","Noto Sans",Arial;}
  header{position:sticky;top:0;background:rgba(11,18,32,.85);backdrop-filter: blur(8px);border-bottom:1px solid var(--brd);padding:12px 16px;z-index:10}
  h1{margin:0;font-size:18px}
  .wrap{max-width:1100px;margin:16px auto;padding:0 16px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin:10px 0}
  input[type="search"]{flex:1;min-width:240px;padding:8px 10px;border:1px solid var(--brd);border-radius:8px;background:#0a1020;color:var(--fg)}
  .btn{display:inline-block;border:1px solid var(--brd);background:#0b1324;color:var(--fg);padding:8px 12px;border-radius:8px;text-decoration:none;font-size:14px;cursor:pointer}
  .btn:hover{border-color:#375184}
  .btn-accent{background:var(--accent);border-color:#1da34f;color:#06220f}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:12px}
  .card{background:var(--card);border:1px solid var(--brd);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:8px}
  .meta{color:var(--muted);font-size:12px}
  .title{font-weight:600;line-height:1.3}
  .thumb{width:100%;height:180px;object-fit:cover;border-radius:8px;border:1px solid var(--brd);background:#0b1220}
  .btnrow{display:flex;flex-wrap:wrap;gap:8px}
  .source{font-size:12px;color:#9db7d8}
  footer{color:#86a1be;text-align:center;padding:20px 0}
  .tabs{display:flex;gap:8px;flex-wrap:wrap}
  .tab{padding:6px 10px;border:1px solid var(--brd);border-radius:999px;cursor:pointer}
  .tab.active{background:#12203a}
  .notice{margin:10px 0;padding:10px;border:1px dashed #5472a3;border-radius:8px;color:#a6c4ff;background:#0b1324}
</style>
</head>
<body>
<header>
  <div class="wrap" style="display:flex;justify-content:space-between;align-items:center;gap:10px">
    <h1>ðŸ“£ PinoyTechFeed Â· Share Dashboard</h1>
    <a class="btn btn-accent" href="/" target="_blank" rel="noopener">Open Site</a>
  </div>
</header>

<main class="wrap">
  <div id="debug" class="notice" style="display:none"></div>

  <div class="toolbar">
    <div class="tabs" id="tabs">
      <span class="tab active" data-filter="">All</span>
      <span class="tab" data-filter="gadgets">Gadgets</span>
      <span class="tab" data-filter="ph">PH News</span>
      <span class="tab" data-filter="tech">Tech &amp; Innovation</span>
    </div>
    <input id="q" type="search" placeholder="Filter by titleâ€¦" />
    <button class="btn" id="copyAll">Copy 3 latest captions</button>
  </div>

  <div id="list" class="grid" aria-live="polite">Loadingâ€¦</div>
</main>

<footer>
  <div class="wrap">Tips: For Page scheduling, open Meta Business Suite and paste the link or the copied caption.</div>
</footer>

<script>
(async function() {
  const FEED_URL = '/feed.xml';
  const SITE_ORIGIN = location.origin;

  const listEl = document.getElementById('list');
  const qEl = document.getElementById('q');
  const tabsEl = document.getElementById('tabs');
  const copyAllEl = document.getElementById('copyAll');
  const debugEl = document.getElementById('debug');

  let items = [];
  let currentFilter = '';

  function slugify(s) {
    return (s||'').toLowerCase().normalize('NFKD')
      .replace(/[\u0300-\u036f]/g,'')
      .replace(/&/g,' and ')
      .replace(/[^a-z0-9]+/g,'-')
      .replace(/^-+|-+$/g,'')
      .replace(/--+/g,'-')
      .slice(0,80);
  }

  function siteUrl(it) {
    return `${SITE_ORIGIN}/p/${slugify(it.title)}.html`;
  }

  function hashtagsFor(tag) {
    if (tag==='gadgets') return '#Gadgets #PinoyTechFeed';
    if (tag==='ph') return '#PHNews #PinoyTechFeed';
    if (tag==='tech') return '#Tech #PinoyTechFeed';
    return '#PinoyTechFeed';
  }

  function toCaption(it) {
    return `${it.title} â€” Read more: ${siteUrl(it)} ${hashtagsFor(it.tag)}`;
  }

  function render() {
    const q = (qEl.value || '').toLowerCase();
    const rows = [];
    for (const it of items) {
      if (currentFilter && it.tag!==currentFilter) continue;
      if (q && !it.title.toLowerCase().includes(q)) continue;

      const cap = toCaption(it);
      rows.push(`
        <article class="card">
          ${it.img ? `<img class="thumb" src="${it.img}" alt="">` : ''}
          <div class="title"><a href="${siteUrl(it)}" target="_blank">${it.title}</a></div>
          <div class="meta">${new Date(it.date).toLocaleString()}</div>
          <div class="source">Category: ${it.tag.toUpperCase()} Â· Source: ${it.source}</div>
          <div class="btnrow">
            <button class="btn copy" data-copy="${encodeURIComponent(cap)}">Copy caption</button>
            <button class="btn copylink" data-link="${siteUrl(it)}">Copy site link</button>
          </div>
        </article>
      `);
    }
    listEl.innerHTML = rows.join('') || `<div class="meta">No items match your filter.</div>`;

    listEl.querySelectorAll('.copy').forEach(b => b.onclick = async()=> {
      const t = decodeURIComponent(b.dataset.copy);
      await navigator.clipboard.writeText(t);
      alert('Copied caption!');
    });
    listEl.querySelectorAll('.copylink').forEach(b => b.onclick = async()=> {
      await navigator.clipboard.writeText(b.dataset.link);
      alert('Copied link!');
    });
  }

  tabsEl.onclick = e=>{
    const t = e.target.closest('.tab');
    if(!t)return;
    [...tabsEl.children].forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    currentFilter = t.dataset.filter;
    render();
  };
  qEl.oninput = render;

  copyAllEl.onclick = async()=>{
    const shown = [...listEl.querySelectorAll('.card')].slice(0,3);
    const caps = shown.map(c=>{
      const t=c.querySelector('.title').innerText;
      const l=c.querySelector('.title a').href;
      return `${t} â€” Read more: ${l} #PinoyTechFeed`;
    }).join('\n\n');
    await navigator.clipboard.writeText(caps);
    alert('Top 3 captions copied!');
  };

  const res = await fetch(FEED_URL);
  const xml = new DOMParser().parseFromString(await res.text(),'text/xml');
  items = Array.from(xml.querySelectorAll('item')).map(it=>{
    const get=t=>it.querySelector(t)?.textContent.trim()||'';
    const link=get('link');
    const img=it.querySelector('enclosure')?.getAttribute('url')||it.querySelector('media\\:content')?.getAttribute('url')||'';
    return { title:get('title'), link, date:get('pubDate'), img, tag:get('category').toLowerCase().includes('ph')?'ph':get('category').toLowerCase().includes('gadget')?'gadgets':'tech', source:get('source') };
  });
  debugEl.textContent=`Loaded ${items.length} items`;
  debugEl.style.display='block';
  render();
})();
</script>
</body>
</html>